<style>
  #modulo-bajas {
    max-width: 1500px;
  }
</style>

<div id="modulo-bajas">
  <v-container fluid>
    
    <!-- FORMULARIO DE BAJA -->
    <v-expand-transition>
      <div v-if="mostrarFormulario && rolUsuarioActual === 'ADMINISTRADOR'">
        <v-row>
          <v-col>
            <v-card>
              <v-card-title style="background-color: #00b293; color: #ffffff;">
                Formulario de baja
              </v-card-title>

              <v-container fluid>
                <!-- Campos del formulario -->
                <v-row justify="center" class="py-2">
                  <v-col cols="12" md="4">
                    <v-text-field outlined v-model="nombreEquipo" label="Nombre de equipo"></v-text-field>
                  </v-col>
                  <v-col cols="12" md="4">
                    <v-text-field outlined v-model="marca" label="Marca"></v-text-field>
                  </v-col>
                  <v-col cols="12" md="4">
                    <v-text-field outlined v-model="modelo" label="Modelo"></v-text-field>
                  </v-col>
                </v-row>

                <v-row justify="center" class="py-2">
                  <v-col cols="12" md="4">
                    <v-text-field outlined v-model="usuario" label="Último usuario"></v-text-field>
                  </v-col>
                  <v-col cols="12" md="4">
                    <v-menu
                      v-model="menuFecha"
                      :close-on-content-click="false"
                      transition="scale-transition"
                      offset-y
                      min-width="auto"
                    >
                      <template v-slot:activator="{ on, attrs }">
                        <v-text-field
                          v-model="fechaBaja"
                          label="Fecha de baja"
                          prepend-icon="mdi-calendar"
                          readonly
                          v-bind="attrs"
                          v-on="on"
                          outlined
                        ></v-text-field>
                      </template>
                      <v-date-picker
                        v-model="fechaBaja"
                        locale="es"
                        @input="menuFecha = false"
                      ></v-date-picker>
                    </v-menu>
                  </v-col>
                  <v-col cols="12" md="4">
                    <v-textarea outlined v-model="descripcion" label="Motivo"></v-textarea>
                  </v-col>
                </v-row>

                <!-- Botón Guardar / Editar -->
                <v-row justify="center" class="py-4">
                  <v-btn color="#00b293" class="white--text" @click="flagEditar ? fnEditar() : fnGuardar()">
                    <v-icon>mdi-content-save</v-icon>
                    {{ flagEditar ? 'Editar' : 'Guardar' }}
                  </v-btn>
                </v-row>
              </v-container>
            </v-card>
          </v-col>
        </v-row>
      </div>
    </v-expand-transition>

    <!-- VISTA PRINCIPAL / TABLA -->
    <div v-show="!mostrarFormulario">
      <v-row>
        <v-col>
          <v-card>
            <v-card-title style="background-color: #00b293; color: #ffffff;">
              Módulo de bajas de equipos
            </v-card-title>

            <v-container fluid>
              <v-text-field
                v-model="search"
                label="Buscar"
                append-icon="mdi-magnify"
                single-line
                hide-details
              ></v-text-field>

              <v-row justify="left">
                <v-col cols="12" xs="8" md="4">
                  <v-btn v-if="rolUsuarioActual === 'ADMINISTRADOR'" color="#00b293" class="white--text" >
                    <v-icon left>mdi-minus-box</v-icon>
                    BAJAS REGISTRADAS
                  </v-btn>
                </v-col>
              </v-row>
            </v-container>

            <!-- TABLA DE BAJAS -->
            <v-row justify="center">
              <v-col md="12">
                <v-data-table :headers="headers" :items="datosTabla" :search="search">
                  <template v-slot:item.ver_mas="{ item }">
                    <v-btn small color="info" @click="verMas(item)">Ver más</v-btn>
                  </template>
                  <template v-slot:item.editar="{ item }">
                    <v-btn v-if="rolUsuarioActual === 'ADMINISTRADOR'" fab small color="warning" @click="fnCargarDatosEditar(item)">
                      <v-icon>mdi-pencil</v-icon>
                    </v-btn>
                  </template>
                  <template v-slot:item.asignar="{ item }">
                    <v-btn v-if="rolUsuarioActual === 'ADMINISTRADOR'" fab small color="#00b293" class="white--text" @click="fnAsignarUsuario(item)">
                      <v-icon>mdi-account-plus</v-icon>
                    </v-btn>
                  </template>
                  <template v-slot:item.estatus="{ item }">
                    <v-switch v-model="item.estatus" @change="fnCambiarEstatus(item)"></v-switch>
                  </template>
                </v-data-table>
              </v-col>
            </v-row>
          </v-card>
        </v-col>
      </v-row>

      <!-- DIALOGO VER MÁS -->
      <v-dialog v-model="dialog" max-width="500">
        <v-card>
          <v-card-title>Datos completos del equipo</v-card-title>
          <v-card-text>
            <ul>
              <li><strong>No. Utl:</strong> {{ usuarioSeleccionado.numUtl }}</li>
              <li><strong>Nombre:</strong> {{ usuarioSeleccionado.nombreEquipo }}</li>
              <li><strong>Marca:</strong> {{ usuarioSeleccionado.marca }}</li>
              <li><strong>Modelo:</strong> {{ usuarioSeleccionado.modelo }}</li>
              <li><strong>Último usuario:</strong> {{ usuarioSeleccionado.usuario }}</li>
              <li><strong>Fecha de baja:</strong> {{ usuarioSeleccionado.fechaBaja }}</li>
              <li><strong>Motivo:</strong> {{ usuarioSeleccionado.descripcion }}</li>
            </ul>
          </v-card-text>
          <v-card-actions class="justify-end">
            <v-btn text @click="dialog = false">Cerrar</v-btn>
          </v-card-actions>
        </v-card>
      </v-dialog>

      <!-- DIALOGO BUSCAR -->
      <v-dialog v-model="dialogBuscar" max-width="400">
        <v-card>
          <v-card-title>Buscar equipo por número</v-card-title>
          <v-card-text>
            <v-text-field
              outlined
              v-model="numeroBuscar"
              label="Número de equipo"
            ></v-text-field>
          </v-card-text>
          <v-card-actions>
            <v-btn color="primary" @click="fnBuscarEquipo()">Buscar</v-btn>
            <v-spacer></v-spacer>
            <v-btn text @click="dialogBuscar = false">Cerrar</v-btn>
          </v-card-actions>
        </v-card>
      </v-dialog>
    </div>
  </v-container>
</div>
